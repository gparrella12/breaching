Investigating use case single_imagenet with server type honest_but_curious.
Model architecture resnet50 loaded with 25,549,352 parameters and 53,173 buffers.
Overall this is a data ratio of     170:1 for target shape [1, 3, 224, 224] given that num_queries=1.
User (of type UserMultiStep) with settings:
    Number of data points: 1

    Threat model:
    User provides labels: False
    User provides buffers: False
    User provides number of data points: True

    Data:
    Dataset: flickr_faces
    user: 0
    
        
    Local FL Setup:
        Number of local update steps: 4
        Data per local update step: 1
        Local learning rate: 0.001

        Threat model:
        Share these hyperparams to server: True

        
Server (of type HonestServer) with settings:
    Threat model: Honest-but-curious
    Number of planned queries: 1
    Has external/public data: False

    Model:
        model specification: resnet50
        model state: default
        public buffers: True

    Secrets: {}
    
Attacker (of type OptimizationBasedAttacker) with settings:
    Hyperparameter Template: invertinggradients

    Objective: Cosine Similarity with scale=1.0 and task reg=0.0
    Regularizers: Total Variation, scale=0.005. p=1 q=1. 
    Augmentations: 

    Optimization Setup:
        optimizer: adam
        signed: hard
        step_size: 0.1
        boxed: True
        max_iterations: 32000
        step_size_decay: step-lr
        langevin_noise: 0.0
        warmup: 100
        grad_clip: None
        callback: 1000
        
Computing user update on user 0 in model mode: eval.
Saved to /user/gparrella/breaching/my_test/optimization_based/inverting_gradients/results/flickr_original.jpg
Reconstructing user data...
Files already downloaded and verified
Recovered labels [60] through strategy yin.
| It: 1 | Rec. loss: 0.0216 |  Task loss: 0.0000 | T: 10.74s
| It: 1001 | Rec. loss: 0.0061 |  Task loss: 0.0000 | T: 1132.77s
| It: 2001 | Rec. loss: 0.0057 |  Task loss: 0.0000 | T: 1130.64s
| It: 3001 | Rec. loss: 0.0059 |  Task loss: 0.0000 | T: 1126.15s
| It: 4001 | Rec. loss: 0.0056 |  Task loss: 0.0000 | T: 1131.94s
| It: 5001 | Rec. loss: 0.0060 |  Task loss: 0.0000 | T: 1132.29s
| It: 6001 | Rec. loss: 0.0064 |  Task loss: 0.0000 | T: 1133.18s
| It: 7001 | Rec. loss: 0.0066 |  Task loss: 0.0000 | T: 1133.33s
| It: 8001 | Rec. loss: 0.0071 |  Task loss: 0.0000 | T: 1130.45s
| It: 9001 | Rec. loss: 0.0066 |  Task loss: 0.0000 | T: 1168.71s
| It: 10001 | Rec. loss: 0.0073 |  Task loss: 0.0000 | T: 1765.21s
| It: 11001 | Rec. loss: 0.0094 |  Task loss: 0.0000 | T: 1814.67s
| It: 12001 | Rec. loss: 0.0077 |  Task loss: 0.0000 | T: 1777.11s
| It: 13001 | Rec. loss: 0.0062 |  Task loss: 0.0000 | T: 1767.54s
| It: 14001 | Rec. loss: 0.0052 |  Task loss: 0.0000 | T: 1769.66s
| It: 15001 | Rec. loss: 0.0073 |  Task loss: 0.0000 | T: 1776.28s
Investigating use case single_imagenet with server type honest_but_curious.
Model architecture resnet50 loaded with 25,549,352 parameters and 53,173 buffers.
Overall this is a data ratio of     170:1 for target shape [1, 3, 224, 224] given that num_queries=1.
User (of type UserMultiStep) with settings:
    Number of data points: 1

    Threat model:
    User provides labels: False
    User provides buffers: False
    User provides number of data points: True

    Data:
    Dataset: flickr_faces
    user: 0
    
        
    Local FL Setup:
        Number of local update steps: 4
        Data per local update step: 1
        Local learning rate: 0.001

        Threat model:
        Share these hyperparams to server: True

        
Server (of type HonestServer) with settings:
    Threat model: Honest-but-curious
    Number of planned queries: 1
    Has external/public data: False

    Model:
        model specification: resnet50
        model state: default
        public buffers: True

    Secrets: {}
    
Attacker (of type OptimizationBasedAttacker) with settings:
    Hyperparameter Template: invertinggradients

    Objective: Cosine Similarity with scale=1.0 and task reg=0.0
    Regularizers: Total Variation, scale=0.005. p=1 q=1. 
    Augmentations: 

    Optimization Setup:
        optimizer: adam
        signed: hard
        step_size: 0.1
        boxed: True
        max_iterations: 32000
        step_size_decay: step-lr
        langevin_noise: 0.0
        warmup: 100
        grad_clip: None
        callback: 1000
        
Computing user update on user 0 in model mode: eval.
Saved to /user/gparrella/breaching/my_test/optimization_based/inverting_gradients/results/flickr_original.jpg
Reconstructing user data...
Files already downloaded and verified
Recovered labels [14] through strategy yin.
| It: 1 | Rec. loss: 0.1168 |  Task loss: 0.0000 | T: 13.06s
| It: 1001 | Rec. loss: 0.0048 |  Task loss: 0.0000 | T: 1465.52s
| It: 2001 | Rec. loss: 0.0045 |  Task loss: 0.0000 | T: 1538.73s
| It: 3001 | Rec. loss: 0.0046 |  Task loss: 0.0000 | T: 1672.50s
| It: 4001 | Rec. loss: 0.0044 |  Task loss: 0.0000 | T: 1679.35s
| It: 5001 | Rec. loss: 0.0043 |  Task loss: 0.0000 | T: 1720.12s
| It: 6001 | Rec. loss: 0.0045 |  Task loss: 0.0000 | T: 1768.50s
| It: 7001 | Rec. loss: 0.0046 |  Task loss: 0.0000 | T: 1770.68s
| It: 8001 | Rec. loss: 0.0046 |  Task loss: 0.0000 | T: 1766.26s
| It: 9001 | Rec. loss: 0.0047 |  Task loss: 0.0000 | T: 1764.03s
| It: 10001 | Rec. loss: 0.0047 |  Task loss: 0.0000 | T: 1779.40s
| It: 11001 | Rec. loss: 0.0046 |  Task loss: 0.0000 | T: 1727.45s
| It: 12001 | Rec. loss: 0.0044 |  Task loss: 0.0000 | T: 1749.35s
| It: 13001 | Rec. loss: 0.0025 |  Task loss: 0.0000 | T: 1651.32s
| It: 14001 | Rec. loss: 0.0023 |  Task loss: 0.0000 | T: 1139.25s
| It: 15001 | Rec. loss: 0.0022 |  Task loss: 0.0000 | T: 1137.35s
| It: 16001 | Rec. loss: 0.0021 |  Task loss: 0.0000 | T: 1139.27s
| It: 17001 | Rec. loss: 0.0020 |  Task loss: 0.0000 | T: 1135.75s
| It: 18001 | Rec. loss: 0.0019 |  Task loss: 0.0000 | T: 1132.89s
| It: 19001 | Rec. loss: 0.0019 |  Task loss: 0.0000 | T: 1135.13s
| It: 20001 | Rec. loss: 0.0019 |  Task loss: 0.0000 | T: 1136.54s
| It: 21001 | Rec. loss: 0.0019 |  Task loss: 0.0000 | T: 1133.30s
| It: 22001 | Rec. loss: 0.0019 |  Task loss: 0.0000 | T: 1134.46s
| It: 23001 | Rec. loss: 0.0018 |  Task loss: 0.0000 | T: 1137.83s
| It: 24001 | Rec. loss: 0.0018 |  Task loss: 0.0000 | T: 1135.60s
| It: 25001 | Rec. loss: 0.0017 |  Task loss: 0.0000 | T: 1134.40s
| It: 26001 | Rec. loss: 0.0017 |  Task loss: 0.0000 | T: 1136.65s
| It: 27001 | Rec. loss: 0.0016 |  Task loss: 0.0000 | T: 1134.48s
| It: 28001 | Rec. loss: 0.0016 |  Task loss: 0.0000 | T: 1135.41s
| It: 29001 | Rec. loss: 0.0017 |  Task loss: 0.0000 | T: 1128.77s
| It: 30001 | Rec. loss: 0.0016 |  Task loss: 0.0000 | T: 1135.80s
| It: 31001 | Rec. loss: 0.0016 |  Task loss: 0.0000 | T: 1134.39s
| It: 32000 | Rec. loss: 0.0016 |  Task loss: 0.0000 | T: 1134.50s
Optimal candidate solution with rec. loss 0.0013 selected.
Reconstruction stats:
Starting evaluations for attack effectiveness report...
/usr/local/lib/python3.8/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

None
Saved to /user/gparrella/breaching/my_test/optimization_based/inverting_gradients/results/flickr_reconstructed.jpg
