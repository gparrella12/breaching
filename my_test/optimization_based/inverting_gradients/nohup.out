Investigating use case single_imagenet with server type honest_but_curious.
Model architecture resnet50 loaded with 25,549,352 parameters and 53,173 buffers.
Overall this is a data ratio of     170:1 for target shape [1, 3, 224, 224] given that num_queries=1.
User (of type UserMultiStep) with settings:
    Number of data points: 1

    Threat model:
    User provides labels: False
    User provides buffers: False
    User provides number of data points: True

    Data:
    Dataset: flickr_faces
    user: 0
    
        
    Local FL Setup:
        Number of local update steps: 4
        Data per local update step: 1
        Local learning rate: 0.001

        Threat model:
        Share these hyperparams to server: True

        
Server (of type HonestServer) with settings:
    Threat model: Honest-but-curious
    Number of planned queries: 1
    Has external/public data: False

    Model:
        model specification: resnet50
        model state: default
        public buffers: True

    Secrets: {}
    
Attacker (of type OptimizationBasedAttacker) with settings:
    Hyperparameter Template: invertinggradients

    Objective: Cosine Similarity with scale=1.0 and task reg=0.0
    Regularizers: Total Variation, scale=0.005. p=1 q=1. 
    Augmentations: 

    Optimization Setup:
        optimizer: adam
        signed: hard
        step_size: 0.1
        boxed: True
        max_iterations: 32000
        step_size_decay: step-lr
        langevin_noise: 0.0
        warmup: 100
        grad_clip: None
        callback: 1000
        
Computing user update on user 0 in model mode: eval.
Saved to /user/gparrella/breaching/my_test/optimization_based/inverting_gradients/results/flickr_original.jpg
Reconstructing user data...
Files already downloaded and verified
Recovered labels [27] through strategy yin.
| It: 1 | Rec. loss: 0.0641 |  Task loss: 0.0000 | T: 14.65s
